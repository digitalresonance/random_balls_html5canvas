window.requestAnimFrame=function(callback){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}();function resizeCanvas(){canvas=document.getElementById("myCanvas");canvas.width=window.innerWidth-5;canvas.height=window.innerHeight-5}var canvas=document.getElementById("myCanvas");var balls=[];var date=new Date;var time=date.getTime();var mousePos={x:9999,y:9999};function getMousePos(canvas,evt){var obj=canvas;var top=0;var left=0;while(obj.tagName!="BODY"){top+=obj.offsetTop;left+=obj.offsetLeft;obj=obj.offsetParent}var mouseX=evt.clientX-left+window.pageXOffset;var mouseY=evt.clientY-top+window.pageYOffset;return{x:mouseX,y:mouseY}}canvas.addEventListener("mouseup",function(evt){var pos=getMousePos(canvas,evt);mousePos.x=pos.x;mousePos.y=pos.y;balls.push(initBalls())});function Ball(x,y,vx,vy,color){this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.color=color;this.radius=15}function initBalls(){var colors=["#ff0000","#FF7F00","#FFFF00","#00FF00","#0000FF","#4B0082","#8B00FF"];var force=[-8,-7,-6,-5,-4,-3,-2,2,3,4,5,6,7,8];var randomcolor=colors[Math.floor(Math.random()*colors.length)];var randomvx=force[Math.floor(Math.random()*force.length)];var randomvy=force[Math.floor(Math.random()*force.length)];return new Ball(mousePos.x,mousePos.y,randomvx,randomvy,randomcolor)}function updateBalls(canvas,balls,timeDiff){var context=canvas.getContext("2d");var collisionDamper=.3;var gravity=.1;var friction=5e-4*timeDiff;for(var n=0;n<balls.length;n++){var ball=balls[n];ball.y+=ball.vy;ball.x+=ball.vx;if(ball.y<canvas.height-(ball.radius+5)){ball.vy+=gravity}if(ball.vx<0){ball.vx+=friction}else if(ball.vx>0){ball.vx-=friction}if(ball.y<canvas.height-(ball.radius+5)){if(ball.vy<0){ball.vy+=friction}else if(ball.vy>0){ball.vy-=friction}}if(ball.y>canvas.height-ball.radius){ball.y=canvas.height-ball.radius-2;if(ball.vy>.5||balls.vy<-.5){ball.vy*=-1;ball.vy*=1-collisionDamper}else{ball.vy=0}}if(ball.y<ball.radius){ball.y=ball.radius+2;ball.vy*=-1;ball.vy*=1-collisionDamper}if(ball.x>canvas.width-ball.radius){ball.x=canvas.width-ball.radius-2;ball.vx*=-1;ball.vy*=1-collisionDamper}if(ball.x<ball.radius){ball.x=ball.radius+2;ball.vx*=-1;ball.vy*=1-collisionDamper}}}function animate(canvas,balls,lastTime,mousePos){var context=canvas.getContext("2d");var date=new Date;var time=date.getTime();var timeDiff=time-lastTime;updateBalls(canvas,balls,timeDiff,mousePos);lastTime=time;context.clearRect(0,0,canvas.width,canvas.height);for(var n=0;n<balls.length;n++){var ball=balls[n];context.beginPath();context.arc(ball.x,ball.y,ball.radius,0,2*Math.PI,false);context.fillStyle=ball.color;context.fill()}requestAnimFrame(function(){animate(canvas,balls,lastTime,mousePos)})}animate(canvas,balls,time,mousePos);